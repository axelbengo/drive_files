<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Drive Public App</title>
<style>
body { font-family: Arial; max-width: 600px; margin: auto; }
button { padding: 8px; margin: 5px 0; }
</style>
</head>
<body>

<div class="app">
  <h2>ğŸ“ Documents</h2>
  <div class="col1">
    <h3>ğŸ“ choisir le fichier Ã  uploader</h3>  
  
    <input type="file" id="fileInput">
    <button onclick="upload()">Uploader</button>
  </div>  
  <div class="col1">  
  
    <h3>ğŸ“ liste des fichiers disponibles</h3>
    <ul id="list"></ul>
  </div>
</div>
<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwX1fl3Y4mJT9y2kWlsFrnqL6wbP_-X2soYLtmikPcHOTMRlW1oT5s4-oPx51amsAg8/exec";

async function loadFiles() {
  const res = await fetch(API_URL);
  const files = await res.json();
  const list = document.getElementById("list");
  list.innerHTML = "";

  files.forEach(file => {
    const li = document.createElement("li");
    li.innerHTML = `<a href="${file.url}" target="_blank">${file.name}</a>`;
    list.appendChild(li);
  });
}

async function upload() {
  const file = document.getElementById("fileInput").files[0];
  const reader = new FileReader();

  reader.onload = async function() {
    const base64 = reader.result.split(",")[1];

    await fetch(API_URL, {
      method: "POST",
      headers: {"Content-Type": "application/x-www-form-urlencoded"},
      body: new URLSearchParams({
        name: file.name,
        type: file.type,
        data: base64
      })
    });

    alert("Upload rÃ©ussi !");
    loadFiles();
  };

  reader.readAsDataURL(file);
}

loadFiles();
</script>

</body>
</html>
